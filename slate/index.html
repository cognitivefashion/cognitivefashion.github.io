<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>IBM Research Cognitive Fashion API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.svg" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://www.ibm.com/us-en/marketplace/8075'>Sign up for an API key</a></li>
            <li><a href='https://github.com/cognitivefashion/cf-sdk-python'>Python SDK</a></li>
            <li><a href='https://www.ibm.com/us-en/marketplace/8075'>Cognitive Fashion site</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="ibm-research-cognitive-fashion">IBM Research Cognitive Fashion</h1>

<p>The <a href="https://www.ibm.com/us-en/marketplace/8075">IBM Research Cognitive Fashion</a> project aims to build a suite of APIs for the fashion industry in order to enable an engaging shopping experience, primarily leveraging natural language and image understanding technologies together with other cognitive capabilities. Developers/in-house IT team can use these APIs to build their own applications. Central to this is a curated domain specific taxonomy/knowledge graph, fashion related content and text/image annotators tuned to the domain of fashion. </p>

<p><a href="https://github.com/cognitivefashion/cf-sdk-python">Python SDK</a></p>

<aside class="notice">
<b>IBM fashion taxonomy</b> is a semi-automatically curated comprehensive hierarchical fashion taxonomy for apparel, footwear, and accessories along with their attributes and relations. The taxonomy is curated from several fashion resources and then hand tuned by domain experts. All the APIs below leverage this fashion taxonomy. Fashion evolves constantly and hence IBM fashion taxonomy is dynamically updated at regular intervals to include the current fashion terms and trends. The user will always have access to the latest fashion taxonomy when using any of these APIs.
</aside>

<h1 id="authentication">Authentication</h1>
<pre class="highlight shell tab-shell"><code><span class="c"># Pass the API key in the header.</span>
curl <span class="s1">'api_endpoint_here'</span> -H <span class="s2">"X-Api-Key: your_api_key"</span>

<span class="c"># If you are making a GET request, </span>
<span class="c"># you may also pass in the API key as a parameter.</span>
curl <span class="s2">"api_endpoint_here"</span>?api_key<span class="o">=</span>your_api_key
</code></pre><pre class="highlight python tab-python"><code><span class="c"># We will use the requests HTTP library for python for all the examples.</span>
<span class="c"># http://docs.python-requests.org</span>

<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">'api_endpoint_here'</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="s">'your_api_key'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="c"># If you are making a GET request, </span>
<span class="c"># you may also pass in the API key as a parameter.</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">'api_endpoint_here'</span>
<span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s">'api_key'</span><span class="p">:</span> <span class="s">'your_api_key'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>Make sure to replace <code class="prettyprint">your_api_key</code> with your API key.</p>
</blockquote>

<p>Cognitive Fashion uses API keys to allow access to the API. You can request for a API key here at our <a href="https://www.ibm.com/us-en/marketplace/8075">portal</a>. Once you sign up you will get a custom url and an API key. The API key has to be included in all API requests to the server. </p>

<p>The preferred way is to include it in a header that looks like the following:</p>

<p><code class="prettyprint">curl &quot;api_endpoint_here&quot; -H &quot;X-Api-Key: your_api_key&quot;</code></p>

<p>If you are making a <code class="prettyprint">GET</code> request, you may also pass in the API key as a parameter:</p>

<p><code class="prettyprint">curl &quot;api_endpoint_here&quot;?api_key=your_api_key</code></p>

<aside class="notice">
You must replace <code>your_api_key</code> with your personal API key.
</aside>

<h1 id="fashion-quote">Fashion quote</h1>
<pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header.</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># Define the API end point.</span>
<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/fashion_quote'</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"quote"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Simplicity is the keynote of all true elegance."</span><span class="p">,</span><span class="w">
 </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Coco Chanel"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint gets a random quote about fashion. Think of this as our <code class="prettyprint">Hello, world!</code> albiet a more interesting one which you can actually use on your websites.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/fashion_quote</code></p>

<h1 id="catalog">Catalog</h1>

<p>The APIs come in two flavors. Some APIs are simple and do not require access to the product catalog. However we have another bunch of powerful APIs which operate on top of the client catalog. The first step is to upload the product catalog. These are some end points for uploading, accessing, modifying and deleting  a product catalog.</p>

<h2 id="product-json-format">Product JSON Format</h2>

<blockquote>
<p>Sample json document for catalog ingestion corresponding to this <a href="http://www.abof.com/product/109FA16AWWWDR9D03Y10-109F-Women-Brown-&amp;-Yellow-Printed-Dress">product</a>.</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"109FA16AWWWDR9D03Y10"</span><span class="p">,</span><span class="w"> 
 </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.abof.com/product/109FA16AWWWDR9D03Y10-109F-Women-Brown-&amp;-Yellow-Printed-Dress"</span><span class="p">,</span><span class="w"> 
 </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-10-12"</span><span class="p">,</span><span class="w"> 
 </span><span class="s2">"out_of_stock"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"109f women brown &amp; yellow printed dress"</span><span class="p">,</span><span class="w"> 
 </span><span class="s2">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dress"</span><span class="p">,</span><span class="w"> 
 </span><span class="s2">"taxonomy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"women;dress"</span><span class="p">,</span><span class="w"> 
 </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="p">,</span><span class="w">  
 </span><span class="s2">"age_group"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"teenager"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"adult"</span><span class="w">
 </span><span class="p">],</span><span class="w"> 
 </span><span class="s2">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="s2">"camera_focus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"full"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"pose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"front"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://images.abofcdn.com/catalog/images/2016/109FA16AWWWDR9D03Y10/Front_Large.jpg"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"model_worn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="w">
  </span><span class="p">},</span><span class="w"> 
  </span><span class="s2">"3"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="s2">"camera_focus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"detail"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"pose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNK"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://images.abofcdn.com/catalog/images/2016/109FA16AWWWDR9D03Y10/Detail_Large.jpg"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"model_worn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="w">
  </span><span class="p">},</span><span class="w"> 
  </span><span class="s2">"2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="s2">"camera_focus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"full"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"pose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"right"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://images.abofcdn.com/catalog/images/2016/109FA16AWWWDR9D03Y10/Right_Large.jpg"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"model_worn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="w">
  </span><span class="p">},</span><span class="w"> 
  </span><span class="s2">"4"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="s2">"camera_focus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"full"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"pose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"back"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://images.abofcdn.com/catalog/images/2016/109FA16AWWWDR9D03Y10/Back_Large.jpg"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"model_worn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="w">
  </span><span class="p">}</span><span class="w">
 </span><span class="p">},</span><span class="w"> 
 </span><span class="s2">"color"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"copper"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"brown"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"yellow"</span><span class="w">
 </span><span class="p">],</span><span class="w"> 
 </span><span class="s2">"pattern"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"printed"</span><span class="w">
 </span><span class="p">],</span><span class="w"> 
 </span><span class="s2">"fabric"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"polyester"</span><span class="w">
 </span><span class="p">],</span><span class="w"> 
 </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"109f"</span><span class="w">
 </span><span class="p">],</span><span class="w"> 
 </span><span class="s2">"occasion"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"brunch"</span><span class="w">
 </span><span class="p">],</span><span class="w">  
 </span><span class="s2">"season"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"summer"</span><span class="w">
 </span><span class="p">],</span><span class="w"> 
 </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"round neck"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sleeveless"</span><span class="w">
 </span><span class="p">],</span><span class="w"> 
 </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Brown and yellow printed dress, has a round neck with tie-up detail on one shoulder, sleeveless, elasticized detail along the waistline, side slits"</span><span class="p">,</span><span class="w"> 
 </span><span class="s2">"style_tip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Club this dress with a pair of sandals. Add on a statement neckpiece for a stylish allure."</span><span class="p">,</span><span class="w"> 
 </span><span class="s2">"available_sizes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"XS"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"S"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"M"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"L"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"XL"</span><span class="w">
 </span><span class="p">],</span><span class="w"> 
 </span><span class="s2">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">2199.0</span><span class="p">,</span><span class="w"> 
 </span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">1100.0</span><span class="p">,</span><span class="w"> 
 </span><span class="s2">"sale_percentage"</span><span class="p">:</span><span class="w"> </span><span class="mf">50.0</span><span class="p">,</span><span class="w">
 </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INR"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>We refer to any <strong>apparel</strong>, <strong>accessory</strong>, or <strong>shoes</strong> as a <strong>product</strong> in the table below. A product in a catalog is represented as a json object with fields specified below. Ingesting the catalog means uploading these json files for all products in the catalog via an API call.</p>

<p>Try to populate as much information available for each product into these fields in the json document. Except for the fields in bold (<strong>id</strong>, <strong>gender</strong>, <strong>name</strong> (for natural language search), <strong>images</strong>(for visual search and visual browse)) all of these are optional. However the the performance of the natural language search is heavily dependent on the richness of these structured fields and is recommended that you provide as much information as possible.</p>

<table><thead>
<tr>
<th>field</th>
<th>type</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>id</strong></td>
<td>string</td>
<td>A unique identifier for the product for which there is a product page and a set of product images associated with it.</td>
</tr>
<tr>
<td>url</td>
<td>string</td>
<td>The corresponding url of the product page.</td>
</tr>
<tr>
<td>date</td>
<td>string</td>
<td>The date when the item was entered into the catalog, in <code class="prettyprint">YYYY-MM-DD</code> format.</td>
</tr>
<tr>
<td>out_of_stock</td>
<td>string</td>
<td>Can either be <code class="prettyprint">yes</code> or <code class="prettyprint">no</code>. This is the field that need to be changed to <code class="prettyprint">yes</code> when a product goes out of stock. By default all search queries will not return out-of-stock products. Note that typically out of stock is at the SKU level. Ideally make this <code class="prettyprint">yes</code>  only when all SKUs for this product are out of stock.</td>
</tr>
<tr>
<td></td>
<td></td>
<td><em>You will typically use this when the product will be replenished. If you think the product will be discontinued and not available again you can delete that product entirely.</em></td>
</tr>
<tr>
<td><strong>name</strong></td>
<td>string</td>
<td>The name of the product. This is generally a free text brief description of the product.</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>The product category.</td>
</tr>
<tr>
<td>taxonomy</td>
<td>string</td>
<td>The complete product taxonomy if known, separated via <code class="prettyprint">;</code>.</td>
</tr>
<tr>
<td><strong>gender</strong></td>
<td>string</td>
<td>The gender for which the product is intended for, can be <code class="prettyprint">male</code>, <code class="prettyprint">female</code> or <code class="prettyprint">unisex</code>.</td>
</tr>
<tr>
<td>age_group</td>
<td>list string</td>
<td>The age group for which the product is intended for. Some suggested tags : <code class="prettyprint">baby</code>, <code class="prettyprint">kid</code>, <code class="prettyprint">teenager</code>, <code class="prettyprint">adult</code>.</td>
</tr>
<tr>
<td><strong>images</strong></td>
<td>list of dict</td>
<td>A list of images available for the product with <code class="prettyprint">image_id</code> as the key and the following fields in the dict.</td>
</tr>
<tr>
<td></td>
<td>image_id</td>
<td>The image id (string).</td>
</tr>
<tr>
<td></td>
<td>image_url</td>
<td>The image url. The actual image will be downloaded from this url to build the visual search index. The image format can be in JPEG,PNG,BMP, or GIF.</td>
</tr>
<tr>
<td></td>
<td>ignore</td>
<td>You can use this field to select what kind of images should be used for visual browse/search.  If <code class="prettyprint">yes</code> then the image will not be downloaded and excluded from visual browse/search. In the example on the right, we ignore all images which have close-up of some details in the product.</td>
</tr>
<tr>
<td></td>
<td>model_worn</td>
<td>If <code class="prettyprint">yes</code> then the image corresponds to the model wearing the particular product. If <code class="prettyprint">no</code> refers to image of the the product only. Use <code class="prettyprint">UNK</code> if not known.</td>
</tr>
<tr>
<td></td>
<td>pose</td>
<td>Refers to the pose/orientation in which the image is taken. Can take one of the following values: <code class="prettyprint">front</code>, <code class="prettyprint">back</code>, <code class="prettyprint">left</code>, <code class="prettyprint">right</code>, <code class="prettyprint">top</code>, <code class="prettyprint">UNK</code>.</td>
</tr>
<tr>
<td></td>
<td>camera_focus</td>
<td>Which part of the model the camera is focussed on. Can take one of the following values: <code class="prettyprint">full</code> (complete view of the model, entire body), <code class="prettyprint">top</code> (upper part of the model above the waist, used in shirts etc.), <code class="prettyprint">bottom</code> (lower part of the model below the waist, used in trousers etc.), <code class="prettyprint">portrait</code> (model face, normally up to the shoulder), <code class="prettyprint">detail</code> (a close-up of some details in the product), <code class="prettyprint">outfit</code> (complete view of the model, entire body along with other apparel and accessories), <code class="prettyprint">UNK</code>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td><em>The fields <code class="prettyprint">ignore</code>,<code class="prettyprint">model_worn</code>, <code class="prettyprint">pose</code> and <code class="prettyprint">camera_focus</code> are optional.</em></td>
</tr>
<tr>
<td>color</td>
<td>list of string</td>
<td>A list of colors terms that describe the colors in the product.</td>
</tr>
<tr>
<td>pattern</td>
<td>list of string</td>
<td>A list of pattern terms that describe the pattern on the fabric.</td>
</tr>
<tr>
<td>fabric</td>
<td>list of string</td>
<td>A list of terms that describe the fabric used in the product.</td>
</tr>
<tr>
<td>brand</td>
<td>list of string</td>
<td>A list of terms that describe the brand name of the product.</td>
</tr>
<tr>
<td>occasion</td>
<td>list of string</td>
<td>A list of terms that describe occasion for which this product can be worn.</td>
</tr>
<tr>
<td>season</td>
<td>list of string</td>
<td>A list of terms that describe the season for which this product can be worn.</td>
</tr>
<tr>
<td>attributes</td>
<td>list of string</td>
<td>A list of terms that describe other attributes like sleeve length, collar etc. of the product.</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>A detailed free text description of the product if available.</td>
</tr>
<tr>
<td>style_tip</td>
<td>string</td>
<td>A detailed free text style tip if available. Typically this suggests what to pair this with.</td>
</tr>
<tr>
<td>available_sizes</td>
<td>list of string</td>
<td>A list of available sizes for the product.</td>
</tr>
<tr>
<td>price</td>
<td>float</td>
<td>The regular list price of the product.</td>
</tr>
<tr>
<td>sale_price</td>
<td>float</td>
<td>The sale price of the product if the product is on sale. If the product is not on sale make this equal to the regular price.</td>
</tr>
<tr>
<td></td>
<td></td>
<td><em>Note that the natural language search by default will use the sale_price field  for the queries that deal with price.</em></td>
</tr>
<tr>
<td>sale_percentage</td>
<td>float</td>
<td>The sale percentage. This is useful for queries related to sale percentages.</td>
</tr>
<tr>
<td>currency</td>
<td>string</td>
<td>The currency used, specified as a 3 letter <a href="http://www.xe.com/iso4217.php">ISO 4217</a> currency code.</td>
</tr>
<tr>
<td></td>
<td></td>
<td><em>The catalog can have products in different currencies, and we will normalize the price internally for serving the query results.</em> (Not yet available)</td>
</tr>
</tbody></table>

<h2 id="add-product-to-a-catalog">Add product to a catalog</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Add product to a catalog.    </span>
<span class="c"># POST /v1/catalog/{catalog_name}/products/{id}</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># You need to give a name to your catalog.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="c"># Some sample data where each product in the catalog is in a json format</span>
<span class="c"># described earlier.</span>
<span class="n">catalog_folder</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>
<span class="n">json_filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">catalog_folder</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">'.'</span><span class="p">)]</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c"># Optional parameters.</span>
<span class="n">params</span><span class="p">[</span><span class="s">'download_images'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'true'</span>

<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">json_filenames</span><span class="p">:</span>
    <span class="c"># load the json file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">catalog_folder</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span><span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/products/</span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s">'id'</span><span class="p">])</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                             <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
                             <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                             <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

    <span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
    <span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"560.34"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
 </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABOFA15AWWWTP1101602"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"n_images"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w">
 </span><span class="s2">"n_images_downloaded"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
 </span><span class="s2">"n_images_ignored"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
 </span><span class="s2">"n_images_error"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
 </span><span class="s2">"n_images_existing"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Add a product json to a catalog and download the images. </p>

<p>Anytime you add a json to a catalog for the first time a new catalog will be automatically created with the name specified in the parameters <code class="prettyprint">catalog_name</code>. The same <code class="prettyprint">catalog_name</code> will have to be used for other end points.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">POST /v1/catalog/{catalog_name}/products/{id}</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
<td></td>
</tr>
<tr>
<td>id</td>
<td>path</td>
<td>(<strong>Required</strong>) The product id.</td>
<td></td>
</tr>
<tr>
<td>data</td>
<td>application/json</td>
<td>(<strong>Required</strong>) The json object file in the the format specified <a href="#product-json-format">earlier</a>.</td>
<td></td>
</tr>
<tr>
<td>download_images</td>
<td>query</td>
<td>By default all the images specified in the json will be downloaded. Set this to <code class="prettyprint">false</code> if you do not want to download the images.</td>
<td><code class="prettyprint">true</code></td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>id</td>
<td>The product id.</td>
</tr>
<tr>
<td>version</td>
<td>The version number. Every update will be assigned a new version number.</td>
</tr>
<tr>
<td>n_images</td>
<td>The total number of images in the json file.</td>
</tr>
<tr>
<td>n_images_downloaded</td>
<td>The actual number of images successfully downloaded.</td>
</tr>
<tr>
<td>n_images_ignored</td>
<td>The total number of images ignored (specified by the field <code class="prettyprint">ignore</code> in <code class="prettyprint">images</code>).</td>
</tr>
<tr>
<td>n_images_error</td>
<td>The number of images for which there was some error in downloading.</td>
</tr>
<tr>
<td>n_images_existing</td>
<td>The number of images which were already downloaded.</td>
</tr>
</tbody></table>

<aside class="notice">
Note that the image download happens only once. If you post the json again the image will not be downloaded again unless there is a change in the image url. 
</aside>

<h2 id="get-product-from-a-catalog">Get product from a catalog</h2>
<pre class="highlight python tab-python"><code><span class="c">#-----------------------------------------------------------------------------</span>
<span class="c"># Get product from a catalog.  </span>
<span class="c"># GET /v1/catalog/{catalog_name}/products/{id}</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># catalog name</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="c"># product id</span>
<span class="nb">id</span> <span class="o">=</span> <span class="s">'20DRA16FWCWFT9010970'</span>

<span class="c"># API end point</span>
<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/products/</span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">,</span><span class="nb">id</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.99"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWFT9010970"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
 </span><span class="s2">"found"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
 </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"color"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
   </span><span class="s2">"copper"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"taxonomy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"women;footwear;sandals-heels"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"age_group"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
   </span><span class="s2">"teenager"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"adult"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="s2">"1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"camera_focus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNK"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"front"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://images.abofcdn.com/catalog/images/2015/20DRA16FWCWFT9010970/Front_Large.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"model_worn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWFT9010970_1_front_UNK.jpg"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"3"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"camera_focus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNK"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"right"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://images.abofcdn.com/catalog/images/2015/20DRA16FWCWFT9010970/Right_Large.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"model_worn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWFT9010970_3_right_UNK.jpg"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"camera_focus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNK"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"left"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://images.abofcdn.com/catalog/images/2015/20DRA16FWCWFT9010970/Left_Large.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"model_worn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWFT9010970_2_left_UNK.jpg"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"5"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"camera_focus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNK"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"top"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://images.abofcdn.com/catalog/images/2015/20DRA16FWCWFT9010970/Top_Large.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"model_worn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWFT9010970_5_top_UNK.jpg"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"4"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"camera_focus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"detail"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNK"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://images.abofcdn.com/catalog/images/2015/20DRA16FWCWFT9010970/Detail_Large.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"model_worn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWFT9010970_4_UNK_detail.jpg"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"6"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"camera_focus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"full"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"front"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://images.abofcdn.com/catalog/images/2015/20DRA16FWCWFT9010970/Look_Large.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"model_worn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image_filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWFT9010970_6_front_full.jpg"</span><span class="w">
   </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"available_sizes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
   </span><span class="s2">"36"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"37"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"38"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"39"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"40"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"41"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"style_tip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"For a comfortable and stylish look, team these sandals with a pair of shorts and a T-shirt. Add on a watch to complete the look."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWFT9010970"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flats"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fabric"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
   </span><span class="s2">"upper: faux suede, sole: tpr"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"pattern"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNK"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sale_percentage"</span><span class="p">:</span><span class="w"> </span><span class="mf">9.966555183946488</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">1346.0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20dresses"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pointy-toed brown sandals with low top styling, has a faux suede upper, stylized lace-ups across the mid-foot that connects to form an ankle loop, patterned outsole"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"season"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNK"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">1495.0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"occasion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNK"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-10-12"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20dresses women brown sandals"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.abof.com/product/20DRA16FWCWFT9010970-20Dresses-Women-Brown-Sandals"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNK"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"out_of_stock"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Get the product json from a catalog.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/catalog/{catalog_name}/products/{id}</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
</tr>
<tr>
<td>id</td>
<td>path</td>
<td>(<strong>Required</strong>) The product id.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>id</td>
<td>The product id.</td>
</tr>
<tr>
<td>version</td>
<td>The version number. Every update will be assigned a new version number.</td>
</tr>
<tr>
<td>data</td>
<td>The product json.</td>
</tr>
</tbody></table>

<h2 id="delete-product-from-a-catalog">Delete product from a catalog</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Delete product from a catalog.</span>
<span class="c"># DELETE /v1/catalog/{catalog_name}/products/{id}</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># Catalog name.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="c"># Product id.</span>
<span class="nb">id</span> <span class="o">=</span> <span class="s">'20DRA16FWCWHL9012909'</span>

<span class="c"># API end point.</span>
<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/products/</span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">,</span><span class="nb">id</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4.01"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
 </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWHL9012909"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Delete the product from a catalog.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">DELETE /v1/catalog/{catalog_name}/products/{id}</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
</tr>
<tr>
<td>id</td>
<td>path</td>
<td>(<strong>Required</strong>) The product id.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>id</td>
<td>The product id.</td>
</tr>
<tr>
<td>version</td>
<td>The version number.</td>
</tr>
<tr>
<td>deleted</td>
<td>This will be true if the product was successfully deleted.</td>
</tr>
</tbody></table>

<h2 id="update-product-in-a-catalog">Update product in a catalog</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Update product in a catalog.  </span>
<span class="c"># PUT  /v1/catalog/{catalog_name}/products/{id}</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># Catalog name.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="c"># Product id.</span>
<span class="nb">id</span> <span class="o">=</span> <span class="s">'20DRA16FWCWFT9010970'</span>

<span class="c"># API end point,</span>
<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/products/</span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">,</span><span class="nb">id</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">data</span><span class="p">[</span><span class="s">'out_of_stock'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'yes'</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c"># Optional parameters.</span>
<span class="n">params</span><span class="p">[</span><span class="s">'download_images'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'true'</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
                        <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                        <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12.83"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
 </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWFT9010970"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Update the product in a catalog. This is useful to make partial/full updates to a product in the catalog. For example</p>

<ul>
<li>A product goes out-of-stock and you can just change the <code class="prettyprint">out_of_stock</code> field in the product json to <code class="prettyprint">yes</code> to reflect this change. </li>
<li>There is a sale for the product and and you can update the <code class="prettyprint">sale_price</code> and <code class="prettyprint">sale_percentage</code> fields.</li>
</ul>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">PUT /v1/catalog/{catalog_name}/products/{id}</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
<td></td>
</tr>
<tr>
<td>id</td>
<td>path</td>
<td>(<strong>Required</strong>) The product id.</td>
<td></td>
</tr>
<tr>
<td>data</td>
<td>application/json</td>
<td>(<strong>Required</strong>) The json object file in the the format specified <a href="#product-json-format">earlier</a> containing only the modifications.</td>
<td></td>
</tr>
<tr>
<td>download_images</td>
<td>query</td>
<td>By default all the images specified in the json will be downloaded. Set this to <code class="prettyprint">false</code> if you do not want to download the images.</td>
<td><code class="prettyprint">true</code></td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>id</td>
<td>The product id.</td>
</tr>
<tr>
<td>version</td>
<td>The version number. Every new update creates a new version number.</td>
</tr>
</tbody></table>

<h2 id="get-info-about-a-product-catalog">Get info about a product catalog</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Get info about a product catalog.  </span>
<span class="c"># GET /v1/catalog/{catalog_name}</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># Catalog name.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="c"># API end point.</span>
<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"num_of_products"</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"39.59"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"num_of_images"</span><span class="p">:</span><span class="w"> </span><span class="mi">54</span><span class="p">,</span><span class="w">
 </span><span class="s2">"catalog_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sample_catalog"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Get some info about the product catalog. Currently this just returns the number of products and the number of images. </p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/catalog/{catalog_name}</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>catalog_name</td>
<td>The catalog name.</td>
</tr>
<tr>
<td>num_of_products</td>
<td>Number of products in the catalog.</td>
</tr>
<tr>
<td>num_of_images</td>
<td>Number of images in the catalog.</td>
</tr>
</tbody></table>

<h2 id="delete-a-product-catalog">Delete a product catalog</h2>
<pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="s">'http://localhost:9080'</span>

<span class="c"># Pass the api key into the header</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="s">'your_api_key'</span><span class="p">}</span>

<span class="c"># You need to give a name to your catalog.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Delete a product catalog.</span>
<span class="c"># DELETE /v1/catalog/{catalog_name}</span>
<span class="c">#------------------------------------------------------------------------------</span>
<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"360.34"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"catalog_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sample_catalog"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Delete a product catalog. Also deletes all the downloaded images.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">DELETE /v1/catalog/{catalog_name}</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>catalog_name</td>
<td>The catalog name.</td>
</tr>
<tr>
<td>deleted</td>
<td>This returns true is the catalog was successfully deleted.</td>
</tr>
</tbody></table>

<h2 id="get-all-catalog-names">Get all catalog names</h2>
<pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># API end point.</span>
<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog_names'</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"catalog_names"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"sample_catalog"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"sample_catalog_2"</span><span class="p">],</span><span class="w">
  </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.78"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Get all the catalog names.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/catalog_names</code></p>

<h3 id="request">Request</h3>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>catalog_names</td>
<td>The catalog names.</td>
</tr>
</tbody></table>

<h1 id="natural-language-search">Natural Language Search</h1>

<p>The Natural Language Search (NLS) for fashion allows the user to search a fashion e-commerce catalog using complex <strong>natural language queries</strong>. Below are a few sample queries that NLS can handle:</p>

<ul>
<li><em>Show me some black graphic print cotton tees under 1k in small size on sale.</em></li>
<li><em>Can you show me some red dresses for my girlfriend for around 100 dollars ?</em></li>
<li><em>Show me some red mandarin collar shirts.</em></li>
<li><em>Show me some edgy longline tees for a party tonight.</em></li>
</ul>

<p>NLS enables the user to query the product catalog in a more natural language as you would have a conversation with seasoned sales assistant. This functionality enables a user to ask his query (requirements) in a more natural manner than the conventional keywords and filter based search. NLS can be seen as replacement for conventional search based on filters and a precursor to a full conversation system. NLS will work on existing product text attributes in product catalog. </p>

<p>Following is a list of some of the features that NLS supports:</p>

<ol>
<li><p><strong>Leverages the underlying IBM Fashion Taxonomy</strong> : NLS is heavily tuned for the fashion domain and leverages the underlying IBM fashion taxonomy. IBM fashion taxonomy is a semi-automatically curated comprehensive hierarchical fashion taxonomy for apparel,footwear, and accessories along with their attributes and relations. The taxonomy is curated from several fashion resources and then hand tuned by domain experts. This enables NLS to a very nuanced understanding of user requirements in the domain of fashion.</p></li>
<li><p><strong>Understands various fashion attributes and user constraints</strong> : NLS is grounded in the fashion taxonomy and can understand various attributes in the query such as gender, category name (apparel,shoes,accessories), color, pattern/print, fabric/material, brand, price, size, occasion, sale/discount other category specific attributes (like sleeves, collar, etc.). NLS  can understand all the constraints on user requirements even when they are expressed in a very natural manner in the form of long complex natural language queries (e.g. Show me red floral dresses for my niece under 1k on sale.).</p></li>
<li><p><strong>Internally handles query synonyms</strong> : IBM Fashion taxonomy is used to map segments of user utterances to nodes in the Fashion taxonomy. This mapping enables understanding of fashion concepts even when they are expressed in many different ways. For example, the user may search for a tee whereas the item may be tagged as a t-shirt in the catalog. NLS understands various synonyms and also common query words for different apparel and accessories.</p></li>
<li><p><strong>Appropriate semantic query back off</strong> : The NLS capability allows showing relevant results to a user query even when there are no enough products that exactly matches with the user requirements. For example, if there are no red floral dresses in the catalog then NLS has a built in back-off strategy that removes attributes (along with color expansion and similar brands substitution) till it finds sufficient number of products. For example, in this case it would first back off to orange/tomato/red floral dresses and then to red dresses and eventually to dresses.</p></li>
<li><p><strong>Color Substitution</strong> : If the user searches for a specific color (say &lsquo;golden colored dresses&rsquo;) and that particular color is not available then we search for other color that look very similar (for example, yellow, yellow green, khaki etc.). The IBM Fashion Taxonomy also includes a detailed taxonomy specific to colors and their corresponding names. Is also provides a notion of visual semantic distance between two colors.</p></li>
<li><p><strong>Brand Substitution</strong> : A similar back-off strategy is incorporated for a limited set of brands. If the user searches for a specific brand (say adidas shoes) and that particular brand is not available then we search for other similar brands (for example, puma shoes). The notion is brand similarity is based on the visual appearance of products and is computed using our visual similarity asset.</p></li>
<li><p><strong>Spelling and phonetic corrections tuned to fashion taxonomy</strong> : Users usually make mistakes when searching with natural language queries. NLS can handles common spelling mistakes in a user query. The spelling correction module is aware of all the fashion related concepts and brands.</p></li>
<li><p><strong>Themes and collections capsules</strong> : NLS offers limited support for search related to themes and collections (e.g. athleisure, monochrome, indigo, ethnic etc. ). We automatically curate the set of apparel, accessories and their attributes that define a fashion theme from various fashion blogs and when the user searches for a theme (say athleisure) then we show items from the catalog that are relevant to that theme.</p></li>
<li><p><strong>Dynamically evolving fashion taxonomy</strong> : Fashion evolves constantly and hence IBM fashion taxonomy is dynamically updated at regular intervals to include the current fashion terms and trends. Since NLS is delivered as a REST API the user will always have access to the latest fashion taxonomy.</p></li>
</ol>

<h2 id="natural-language-search">Natural Language Search</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Natural Language Search </span>
<span class="c"># GET /v1/catalog/{catalog_name}/natural_language_search</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># Catalog name.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/natural_language_search'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s">'query_text'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Watson show me some shrigs for my neice'</span>
<span class="c"># Optional parameters.</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_number_of_results'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_number_of_backoffs'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="c"># Get more info about the relevant results</span>
<span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'products'</span><span class="p">]:</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">product</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span>
    <span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/products/</span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">,</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="si">%</span><span class="s">s </span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'name'</span><span class="p">]))</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"18.14"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWHL9015309"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"backoff_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWPP9014709"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"backoff_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w">
 </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Search the product catalog using a natural language query (e.g. <code class="prettyprint">Show me some black graphic print tees on sale.</code>).</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/catalog/{catalog_name}/natural_language_search</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
<td></td>
</tr>
<tr>
<td>query_text</td>
<td>query</td>
<td>(<strong>Required</strong>) The natural language search query. (e.g. <code class="prettyprint">Show me some red graphic print tees under 1k.</code>`)</td>
<td></td>
</tr>
<tr>
<td>max_number_of_results</td>
<td>query</td>
<td>The maximum number of results to return.</td>
<td>12</td>
</tr>
<tr>
<td>max_number_of_backoffs</td>
<td>query</td>
<td>The maximum number of backoffs to use if there are no exact matches. Set this to 0 if you do not want any backoffs.</td>
<td>5</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td><strong>products</strong></td>
<td>A sorted list of products in the catalog relevant to the query.</td>
</tr>
<tr>
<td>id</td>
<td>The id of the product.</td>
</tr>
<tr>
<td>backoff_number</td>
<td>An integer specifying if backoff was used for retrieving this result. (0 corresponds to no backoff, 1 corresponds to backoff once and so on)</td>
</tr>
</tbody></table>

<h2 id="get-elasticsearch-queries">Get elasticsearch queries</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># elasticsearch queries </span>
<span class="c"># GET /v1/natural_language_search/elasticsearch_queries</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/natural_language_search/elasticsearch_queries'</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s">'query_text'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Show me some peach graphic print tees for my neice under 1k on sale.'</span>
<span class="c"># Optional parameters.</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_number_of_results'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_number_of_backoffs'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6.35"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"elasticsearch_queries"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="s2">"sort"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"desc"</span><span class="p">}}],</span><span class="w"> </span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"minimum_should_match"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"lte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"terms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"female"</span><span class="p">,</span><span class="w"> </span><span class="s2">"women"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"term"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"out_of_stock"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">}}]}}],</span><span class="w"> </span><span class="s2">"should"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"t-shirt"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"category^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tee"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"category^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}}],</span><span class="w"> </span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"color^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"minimum_should_match"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"should"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"graphic"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"pattern^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"printed"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"pattern^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"print"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"pattern^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description^1.0"</span><span class="p">]}}]}}]}},</span><span class="w"> </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">},</span><span class="w"> 
  </span><span class="p">{</span><span class="s2">"sort"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"desc"</span><span class="p">}}],</span><span class="w"> </span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"minimum_should_match"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"lte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"terms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"female"</span><span class="p">,</span><span class="w"> </span><span class="s2">"women"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"term"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"out_of_stock"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">}}]}}],</span><span class="w"> </span><span class="s2">"should"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"t-shirt"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"category^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tee"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"category^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}}],</span><span class="w"> </span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"minimum_should_match"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"should"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tomato"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"color^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"orange"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"color^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"color^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}}]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"minimum_should_match"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"should"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"graphic"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"pattern^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"printed"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"pattern^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"print"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"pattern^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description^1.0"</span><span class="p">]}}]}}]}},</span><span class="w"> </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">},</span><span class="w"> 
  </span><span class="p">{</span><span class="s2">"sort"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"desc"</span><span class="p">}}],</span><span class="w"> </span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"minimum_should_match"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"lte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"terms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"female"</span><span class="p">,</span><span class="w"> </span><span class="s2">"women"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"term"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"out_of_stock"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">}}]}}],</span><span class="w"> </span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"color^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}}],</span><span class="w"> </span><span class="s2">"should"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"t-shirt"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"category^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tee"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"category^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}}]}},</span><span class="w"> </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">},</span><span class="w"> 
  </span><span class="p">{</span><span class="s2">"sort"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"desc"</span><span class="p">}}],</span><span class="w"> </span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"lte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"terms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"female"</span><span class="p">,</span><span class="w"> </span><span class="s2">"women"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"term"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"out_of_stock"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">}}]}}],</span><span class="w"> </span><span class="s2">"minimum_should_match"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"should"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"t-shirt"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"category^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tee"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"category^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}}]}},</span><span class="w"> </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">},</span><span class="w"> 
  </span><span class="p">{</span><span class="s2">"sort"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"desc"</span><span class="p">}}],</span><span class="w"> </span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"minimum_should_match"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"lte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"terms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"female"</span><span class="p">,</span><span class="w"> </span><span class="s2">"women"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"term"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"out_of_stock"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">}}]}}],</span><span class="w"> </span><span class="s2">"should"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"graphic"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"pattern^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"printed"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"pattern^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"print"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"pattern^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description^1.0"</span><span class="p">]}}],</span><span class="w"> </span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"knit shirt"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"category^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"color^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}}]}},</span><span class="w"> </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">},</span><span class="w"> 
  </span><span class="p">{</span><span class="s2">"sort"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"desc"</span><span class="p">}}],</span><span class="w"> </span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"lte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"sale_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"terms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"female"</span><span class="p">,</span><span class="w"> </span><span class="s2">"women"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"term"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"out_of_stock"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">}}]}}],</span><span class="w"> </span><span class="s2">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"knit shirt"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"category^2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}},</span><span class="w"> </span><span class="p">{</span><span class="s2">"multi_match"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"phrase"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"color^5.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name^1.0"</span><span class="p">]}}]}},</span><span class="w"> </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<aside class="notice">
The next set of natural language search APIs are genric APIs in that they do not depend on the product catalog.
</aside>

<p>Parse any fashion related query (e.g. <code class="prettyprint">Show me some red graphic print tees for my neice under 1k on sale.</code>) in natural language and return a list of elasticsearch queries in the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html">query DSL format</a>.  The queries are ordered from specific to general queries. The suggested usage is to first fire the first query. If there are no sufficient results then fire the next query and so on. The queries use the field names as specified in the <a href="#product-json-format">product JSON format</a>.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/natural_language_search/elasticsearch_queries</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>query_text</td>
<td>query</td>
<td>(<strong>Required</strong>) The natural language search query. (e.g. <code class="prettyprint">Show me some red graphic print tees for my neice under 1k on sale.</code>)</td>
<td></td>
</tr>
<tr>
<td>max_number_of_results</td>
<td>query</td>
<td>The maximum number of results to return.</td>
<td>12</td>
</tr>
<tr>
<td>max_number_of_backoffs</td>
<td>query</td>
<td>The maximum number of backoffs to use if there are no exact matches. Set this to 0 if you do not want any backoffs.</td>
<td>5</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>elasticsearch_queries</td>
<td>A list of elasticsearch queries (ordered from specific to general) in the <a href="(https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html)">query DSL format</a>.</td>
</tr>
</tbody></table>

<h2 id="parse-fashion-query-text">Parse fashion query/text</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Parse fashion query/text. </span>
<span class="c"># GET /v1/natural_language_search/parse</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/natural_language_search/parse'</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s">'query_text'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Show me some red graphic print tees for my neice under 1k on sale.'</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"parse"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"apparel"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"synonyms"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
     </span><span class="s2">"t-shirt"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"tee"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"hypernyms"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
     </span><span class="s2">"knit shirt"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tee"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"hyponyms"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"color"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
     </span><span class="p">{</span><span class="w">
      </span><span class="s2">"similar_colors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
       </span><span class="s2">"red"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"tomato"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"orange"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"synonyms"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
       </span><span class="s2">"red"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="w">
     </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"pattern"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
     </span><span class="p">{</span><span class="w">
      </span><span class="s2">"synonyms"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
       </span><span class="s2">"graphic"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"graphic"</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="p">{</span><span class="w">
      </span><span class="s2">"synonyms"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
       </span><span class="s2">"printed"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"print"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"print"</span><span class="w">
     </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rupee"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"upper_limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
     </span><span class="s2">"lower_limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
     </span><span class="s2">"sale_percentage_lower_limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">}</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"remaining_tokens"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
   </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="w">
  </span><span class="p">}</span><span class="w">
 </span><span class="p">],</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.85"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Given any natural language fashion query this endpoint parses the query and returns an intermediate structured parse of the query.</p>

<aside class="notice">
The structured parse is grounded in the fashion taxonomy and can understand various apparel/accessory names and their corresponding attributes like gender, category name (apparel,shoes,accessories), color, pattern/print, fabric/material, brand, price (can handle under, above, around and currency denotations.), size, occasion, sale/discount and other category specific attributes defined by the fashion taxonomy. The structured parse is also enriched using the fashion taxonomy to include synonyms for apparel terms, hyponyms (any its synonyms) for apparel terms, synonyms for attribute terms, hypernyms for query-backoff and other similar color and brand names.
</aside>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/natural_language_search/parse</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>query_text</td>
<td>query</td>
<td>(<strong>Required</strong>) The natural language search query. (e.g. <code class="prettyprint">Show me some red graphic print tees for my neice under 1k on sale.</code>)</td>
<td></td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>parse</td>
<td>A list of structured parse of the natural language query grounded in the fashion taxonomy (see the sample json).  For gender agnostic queries returns two parses one for each gender. If the text contains multiple apparel returns one parse for each apparel.</td>
</tr>
</tbody></table>

<h2 id="get-search-terms">Get search terms</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Get search terms. </span>
<span class="c"># GET /v1/natural_language_search/search_terms</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/natural_language_search/search_terms'</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s">'query_text'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Show me some red graphic print tees for my neice under 1k on sale.'</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.13"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"search_terms"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"apparel"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"t-shirt"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"tee"</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"color"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"red"</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"pattern"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"graphic"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"printed"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"print"</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"apparel_hypernyms"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"knit shirt"</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"similar_colors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"tomato"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"orange"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"red"</span><span class="w">
   </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
 </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Parse a fashion related natural language query and generate search terms for its constituent apparel and various attributes. These search terms are used to compose the final elasticsearch/solr query and includes synonyms and hyponyms for the apparel and attributes.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/natural_language_search/search_terms</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>query_text</td>
<td>query</td>
<td>(<strong>Required</strong>) The natural language search query. (e.g. <code class="prettyprint">Show me some red graphic print tees for my neice under 1k on sale.</code>)</td>
<td></td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>search_terms</td>
<td>A list of search terms corresponding to each parse.</td>
</tr>
</tbody></table>

<h2 id="spelling-correction">Spelling Correction</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Spelling correction. </span>
<span class="c"># GET /v1/natural_language_search/spell_correct</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/natural_language_search/spell_correct'</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s">'query_text'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'show me some purlep floaral dreses for my wife'</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.24"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"corrected_text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"show me some purple floral dress for my wife"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Correct any spelling mistakes in the query. This is a lightweight spelling correction module that is tuned to the fasion taxonomy.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/natural_language_search/spell_correct</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>query_text</td>
<td>query</td>
<td>(<strong>Required</strong>) The natural language search query. (e.g. <code class="prettyprint">show me some purlep floaral dreses for my wife.</code>)</td>
<td></td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>corrected_text</td>
<td>The text with the spelling corrected.</td>
</tr>
</tbody></table>

<h1 id="visual-search">Visual Search</h1>

<p>A collection of APIs for enabling a better search experience using the catalog images. Visual search helps a consumer discover exact match or show similar fashion products based on image search. </p>

<p>These APIs support the following two use cases:</p>

<ol>
<li><p><strong>Visual Browse:  Show me more like this</strong> A user clicks on an existing apparel/accessory image in the catalog and visual browse will fetch and display similar looking products from the catalog. This is a more interactive way of browsing the catalog based on visual search. It essentially recreates the experience of asking a shopkeeper Show me more dresses like this. and encourages serendipitous buying. This can also be used for finding other similar looks for any product in the catalog.</p></li>
<li><p><strong>Visual Search: Search the look</strong> Consumer can upload any fashion image of his/her liking and visual search will show visually similar products that exist in the catalog. </p></li>
</ol>

<h2 id="build-visual-search-index">Build visual search index</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Build the visual search index.  </span>
<span class="c"># GET /v1/catalog/{catalog_name}/visual_search_index</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># Catalog name.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/visual_search_index'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"done"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"visual_search_index"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="s2">"num_of_images_missing_features"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"num_of_images_indexed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"num_of_images_ignored"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"num_of_products"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-21 03:46:32.043609"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"finish_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-21 03:47:24.785563"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"num_of_images"</span><span class="p">:</span><span class="w"> </span><span class="s2">"60"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"feature_computation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="s2">"num_of_images_ignored"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"num_of_images_existing"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"num_of_images_error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"num_of_images_processed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46"</span><span class="w">
  </span><span class="p">}</span><span class="w">
 </span><span class="p">},</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"52746.07"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Build the visual search index.</p>

<p>Before you can start using the visual search and visual browse APIs the visual search index has to be built first. This API computes the feature representations for all the uploaded images and then builds an index for fast nearest neighbor retrieval.</p>

<aside class="notice">
This is a one time long running operation. Currently it takes around 1-2 seconds to compute the features for one image on a bluemix instance (until bluemix supports GPU instances). Depending on your catalog size you will have to wait till the index creation is completed to start using the visual search APIs. You can query the status of the index creation using the GET endpoint. The index is built when the status becomes `done`
</aside>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">POST /v1/catalog/{catalog_name}/visual_search_index</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
<td></td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td><strong>status</strong></td>
<td>A json containing various info about the current status of the index building process.</td>
</tr>
<tr>
<td>status</td>
<td>The current status of the index building process. The status can be one of <code class="prettyprint">computing_features</code>,<code class="prettyprint">building_index</code>,or <code class="prettyprint">done</code>. The index is built when the status becomes <code class="prettyprint">done</code>.</td>
</tr>
<tr>
<td>num_of_products</td>
<td>The number of products in the catalog.</td>
</tr>
<tr>
<td>num_of_images</td>
<td>The total number of images in the catalog.</td>
</tr>
<tr>
<td>start_time</td>
<td>The time when the index building started.</td>
</tr>
<tr>
<td>finish_time</td>
<td>The time when the index building finished.</td>
</tr>
<tr>
<td><strong>feature_computation</strong></td>
<td>Info about feature computation.</td>
</tr>
<tr>
<td>num_of_images_error</td>
<td>The number of images for which there was some error in feature computation.</td>
</tr>
<tr>
<td>num_of_images_ignored</td>
<td>The number of images that were ignored (for example the images of type <code class="prettyprint">detail</code>).</td>
</tr>
<tr>
<td>num_of_images_existing</td>
<td>The number of images for which the features were already computed (in case of building a new index with new products added).</td>
</tr>
<tr>
<td>num_of_images_processed</td>
<td>The total number of images for which the features were computed.</td>
</tr>
<tr>
<td><strong>visual_search_index</strong></td>
<td>Info about the index building.</td>
</tr>
<tr>
<td>num_of_images_missing_features</td>
<td>The number of images for which there was no feature found.</td>
</tr>
<tr>
<td>num_of_images_ignored</td>
<td>The number of images that were ignored (for example the images of type <code class="prettyprint">detail</code>).</td>
</tr>
<tr>
<td>num_of_images_index</td>
<td>The total number of images finally indexed.</td>
</tr>
</tbody></table>

<aside class="notice">
Any time you add new images to the catalog you will have to rebuild the index. Note that the features for the old images will still be saved and we will be computing the features only for the newly added images.
</aside>

<aside class="warning">
The current version supports building only one index at the same time and does not allow you to build another index when a current index building process in running. Please wait till the current index creation is completed. 
</aside>

<h2 id="get-visual-search-index-status">Get visual search index status</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Get the status of the visual search index. </span>
<span class="c"># GET  /v1/catalog/{catalog_name}/visual_search_index</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># Catalog name.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/visual_search_index'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"computing_features"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"visual_search_index"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"num_of_images_missing_features"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"num_of_images_indexed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"num_of_images_ignored"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="w">
 </span><span class="p">},</span><span class="w">
 </span><span class="s2">"num_of_products"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.72"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-21 04:05:50.445071"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"finish_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"num_of_images"</span><span class="p">:</span><span class="w"> </span><span class="s2">"60"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"feature_computation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"num_of_images_ignored"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"num_of_images_existing"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"num_of_images_error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"num_of_images_processed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19"</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Get the status of the visual search index.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/catalog/{catalog_name}/visual_search_index</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
<td></td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td><strong>status</strong></td>
<td>A json containing various info about the current status of the index building process.</td>
</tr>
<tr>
<td>status</td>
<td>The current status of the index building process. The status can be one of <code class="prettyprint">computing_features</code>,<code class="prettyprint">building_index</code>,or <code class="prettyprint">done</code>. The index is built when the status becomes <code class="prettyprint">done</code>.</td>
</tr>
<tr>
<td>num_of_products</td>
<td>The number of products in the catalog.</td>
</tr>
<tr>
<td>num_of_images</td>
<td>The total number of images in the catalog.</td>
</tr>
<tr>
<td>start_time</td>
<td>The time when the index building started.</td>
</tr>
<tr>
<td>finish_time</td>
<td>The time when the index building finished.</td>
</tr>
<tr>
<td><strong>feature_computation</strong></td>
<td>Info about feature computation.</td>
</tr>
<tr>
<td>num_of_images_error</td>
<td>The number of images for which there was some error in feature computation.</td>
</tr>
<tr>
<td>num_of_images_ignored</td>
<td>The number of images that were ignored (for example the images of type <code class="prettyprint">detail</code>).</td>
</tr>
<tr>
<td>num_of_images_existing</td>
<td>The number of images for which the features were already computed (in case of building a new index with new products added).</td>
</tr>
<tr>
<td>num_of_images_processed</td>
<td>The total number of images for which the features were computed.</td>
</tr>
<tr>
<td><strong>visual_search_index</strong></td>
<td>Info about the index building.</td>
</tr>
<tr>
<td>num_of_images_missing_features</td>
<td>The number of images for which there was no feature found.</td>
</tr>
<tr>
<td>num_of_images_ignored</td>
<td>The number of images that were ignored (for example the images of type <code class="prettyprint">detail</code>).</td>
</tr>
<tr>
<td>num_of_images_index</td>
<td>The total number of images finally indexed.</td>
</tr>
</tbody></table>

<h2 id="delete-visual-search-index">Delete visual search index</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Delete the visual search index. </span>
<span class="c"># DELETE  /v1/catalog/{catalog_name}/visual_search_index</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># Catalog name.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/visual_search_index'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"39.63"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"catalog_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sample_catalog"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Delete the visual search index.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">DELETE /v1/catalog/{catalog_name}/visual_search_index</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
<td></td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>catalog_name</td>
<td>The catalog name.</td>
</tr>
<tr>
<td>deleted</td>
<td>This is <code class="prettyprint">true</code> if the index was successfully deleted.</td>
</tr>
</tbody></table>

<h2 id="visual-browse">Visual Browse</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Visual Browse</span>
<span class="c">#</span>
<span class="c"># Get other visually similar products in the catalog.</span>
<span class="c"># GET /v1/catalog/{catalog_name}/visual_search/{id}/{image_id}</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># Catalog name.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="nb">id</span> <span class="o">=</span><span class="s">'109FA16AWWWSG9G06Y05'</span>
<span class="n">image_id</span> <span class="o">=</span> <span class="s">'1'</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/visual_browse/</span><span class="si">%</span><span class="s">s/</span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">,</span><span class="nb">id</span><span class="p">,</span><span class="n">image_id</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c"># Optional parameters.</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_number_of_results'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="c"># List the relevant images</span>
<span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'products'</span><span class="p">]:</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">product</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span>
    <span class="n">image_id</span> <span class="o">=</span> <span class="n">product</span><span class="p">[</span><span class="s">'image_id'</span><span class="p">]</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">product</span><span class="p">[</span><span class="s">'similarity'</span><span class="p">]</span>
    <span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/products/</span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">,</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="n">image_url</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'images'</span><span class="p">][</span><span class="n">image_id</span><span class="p">][</span><span class="s">'image_url'</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="si">%</span><span class="s">s </span><span class="si">%</span><span class="s">s </span><span class="si">%1.2</span><span class="s">f </span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span><span class="n">image_id</span><span class="p">,</span><span class="n">score</span><span class="p">,</span><span class="n">image_url</span><span class="p">))</span>

</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.96"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWHL9012909"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"similarity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9999205280983006</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWHL9012909"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"similarity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.47892576456069946</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWPP9014709"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"similarity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.4464869499206543</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWHL9015309"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"similarity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.429345965385437</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWHL9012909"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"similarity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.39676886796951294</span><span class="w">
  </span><span class="p">}</span><span class="w">
 </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Find other similar images in the product catalog for a given image based on visual appearance.</p>

<aside class="notice">
Note that the visual search index has to be built first before we can use this API.  
</aside>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/catalog/{catalog_name}/visual_browse/{id}/{image_id}</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
<td></td>
</tr>
<tr>
<td>id</td>
<td>path</td>
<td>(<strong>Required</strong>) The product id.</td>
<td></td>
</tr>
<tr>
<td>image_id</td>
<td>path</td>
<td>(<strong>Required</strong>) The image id.</td>
<td></td>
</tr>
<tr>
<td>max_number_of_results</td>
<td>query</td>
<td>maximum number of results to return</td>
<td>12</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td><strong>products</strong></td>
<td>A sorted list of other visually similar images. The first item in the list is the specified image.</td>
</tr>
<tr>
<td>image_id</td>
<td>The image id.</td>
</tr>
<tr>
<td>id</td>
<td>The product id.</td>
</tr>
<tr>
<td>similarity</td>
<td>The similarity score in the range from 0(dissimilar)  to 1 (similar).</td>
</tr>
</tbody></table>

<h2 id="visual-search">Visual Search</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Visual Search</span>
<span class="c">#</span>
<span class="c"># Get visually similar products in the catalog for an uploaded image.</span>
<span class="c"># POST /v1/catalog/{catalog_name}/visual_search</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="c"># Catalog name.</span>
<span class="n">catalog_name</span> <span class="o">=</span> <span class="s">'sample_catalog'</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/visual_search'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c"># Optional parameters.</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_number_of_results'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">headers</span><span class="p">[</span><span class="s">'Content-Type'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'image/jpeg'</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
                        <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                        <span class="n">data</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s">'test_image_1.jpeg'</span><span class="p">,</span><span class="s">'rb'</span><span class="p">))</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="c"># List the relevant images</span>
<span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'products'</span><span class="p">]:</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">product</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span>
    <span class="n">image_id</span> <span class="o">=</span> <span class="n">product</span><span class="p">[</span><span class="s">'image_id'</span><span class="p">]</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">product</span><span class="p">[</span><span class="s">'similarity'</span><span class="p">]</span>
    <span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/catalog/</span><span class="si">%</span><span class="s">s/products/</span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">,</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="n">image_url</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'images'</span><span class="p">][</span><span class="n">image_id</span><span class="p">][</span><span class="s">'image_url'</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="si">%</span><span class="s">s </span><span class="si">%</span><span class="s">s </span><span class="si">%1.2</span><span class="s">f </span><span class="si">%</span><span class="s">s'</span><span class="o">%</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span><span class="n">image_id</span><span class="p">,</span><span class="n">score</span><span class="p">,</span><span class="n">image_url</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1333.02"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWHL9012909"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"similarity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9999205280983006</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWHL9012909"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"similarity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.47892576456069946</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWPP9014709"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"similarity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.4464869499206543</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWHL9015309"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"similarity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.429345965385437</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20DRA16FWCWHL9012909"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"similarity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.39676886796951294</span><span class="w">
  </span><span class="p">}</span><span class="w">
 </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Find other similar images in the product catalog for a given uploaded image based on visual appearance.</p>

<aside class="notice">
Note that the visual search index has to be built first before we can use this API.  
</aside>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">POST /v1/catalog/{catalog_name}/visual_search</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>catalog_name</td>
<td>path</td>
<td>(<strong>Required</strong>) The catalog name.</td>
<td></td>
</tr>
<tr>
<td>data</td>
<td>image/jpeg</td>
<td>(<strong>Required</strong>) The image. The image can be in PNG, JPEG, BMP, or GIF.</td>
<td></td>
</tr>
<tr>
<td>max_number_of_results</td>
<td>query</td>
<td>maximum number of results to return</td>
<td>12</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td><strong>products</strong></td>
<td>A sorted list of other visually similar images. The first item in the list is the specified image.</td>
</tr>
<tr>
<td>image_id</td>
<td>The image id.</td>
</tr>
<tr>
<td>id</td>
<td>The product id.</td>
</tr>
<tr>
<td>similarity</td>
<td>The similarity score in the range from 0(dissimilar)  to 1 (similar).</td>
</tr>
</tbody></table>

<h1 id="colors">Colors</h1>

<p>These are a few APIs for dealing with color terms. A <strong>color term</strong>, also known as a color name, is a word or phrase that refers to a specific color. For example <em>red</em> is the color term used for a color with RGB values [255,0,0]. While the number of color terms are quite huge we restrict ourselves a set of color terms that are broadly understood by a layperson and skip the more esoteric color terms. Color similarities are computed using the <a href="https://en.wikipedia.org/wiki/Color_difference">Delta E (CIE2000)</a> metric in the LAB space.</p>

<h2 id="get-color-terms">Get color terms</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Get color terms. </span>
<span class="c"># GET /v1/colors/color_terms</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/colors/color_terms'</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s">'r'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">106</span>
<span class="n">params</span><span class="p">[</span><span class="s">'g'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">103</span>
<span class="n">params</span><span class="p">[</span><span class="s">'b'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">95</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6.37"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"color_terms"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"gray"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"grey"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"teal"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"brown"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"olive"</span><span class="w">
 </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Get the closest color name for a given color (specified by <a href="https://en.wikipedia.org/wiki/RGB_color_model">RGB color model</a>).</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/colors/color_terms</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>r</td>
<td>query</td>
<td>(<strong>Required</strong>) The value for the red channel in the RGB color model (in the range 0 to 255).</td>
</tr>
<tr>
<td>g</td>
<td>query</td>
<td>(<strong>Required</strong>) The value for the green channel in the RGB color model (in the range 0 to 255).</td>
</tr>
<tr>
<td>b</td>
<td>query</td>
<td>(<strong>Required</strong>) The value for the blue channel in the RGB color model (in the range 0 to 255).</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>color_terms</td>
<td>A list of five closest color terms.</td>
</tr>
</tbody></table>

<h2 id="get-similar-colors">Get similar colors</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Get similar colors. </span>
<span class="c"># GET /v1/colors/similar_colors</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/colors/similar_colors'</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s">'color_term'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'purple'</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"similar_colors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"purple"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"violet"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"navy blue"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"maroon"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blue"</span><span class="w">
 </span><span class="p">],</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Get other color terms similar to a given color term.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">GET /v1/colors/similar_colors</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>color_term</td>
<td>query</td>
<td>(<strong>Required</strong>) The color term.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>similar_colors</td>
<td>A list of five closest color terms.</td>
</tr>
</tbody></table>

<h2 id="dominant-color-palette">Dominant color palette</h2>
<pre class="highlight python tab-python"><code><span class="c">#------------------------------------------------------------------------------</span>
<span class="c"># Dominant color palette. </span>
<span class="c"># POST /v1/colors/image_color_palette</span>
<span class="c">#------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">props</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Replace this with the custom url generated for you.</span>
<span class="n">api_gateway_url</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s">'api_gateway_url'</span><span class="p">]</span>

<span class="c"># Pass the api key into the header</span>
<span class="c"># Replace 'your_api_key' with your API key.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'X-Api-Key'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]}</span>

<span class="n">api_endpoint</span> <span class="o">=</span> <span class="s">'/v1/colors/image_color_palette'</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">api_gateway_url</span><span class="p">,</span><span class="n">api_endpoint</span><span class="p">)</span>

<span class="n">headers</span><span class="p">[</span><span class="s">'Content-Type'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'image/jpeg'</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s">'test_image_2.jpeg'</span><span class="p">,</span><span class="s">'rb'</span><span class="p">))</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Sample json response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"color_palette"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"rgb"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="mi">240</span><span class="p">,</span><span class="w">
    </span><span class="mi">86</span><span class="p">,</span><span class="w">
    </span><span class="mi">74</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"entrylevel_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tomato"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#f0564a"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tart orange"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"universal_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"rgb"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="mi">247</span><span class="p">,</span><span class="w">
    </span><span class="mi">243</span><span class="p">,</span><span class="w">
    </span><span class="mi">248</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"entrylevel_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"off white"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#f7f3f8"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"off white"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"universal_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"white"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"rgb"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="mi">246</span><span class="p">,</span><span class="w">
    </span><span class="mi">171</span><span class="p">,</span><span class="w">
    </span><span class="mi">216</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"entrylevel_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pink"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#f6abd8"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"light hot pink"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"universal_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pink"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"rgb"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="mi">66</span><span class="p">,</span><span class="w">
    </span><span class="mi">52</span><span class="p">,</span><span class="w">
    </span><span class="mi">52</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"entrylevel_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"black"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#423434"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"old burgundy"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"universal_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"black"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="s2">"rgb"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="mi">204</span><span class="p">,</span><span class="w">
    </span><span class="mi">139</span><span class="p">,</span><span class="w">
    </span><span class="mi">113</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"entrylevel_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"coral"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#cc8b71"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"copper crayola"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"universal_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"orange"</span><span class="w">
  </span><span class="p">}</span><span class="w">
 </span><span class="p">],</span><span class="w">
 </span><span class="s2">"time_ms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2139.95"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Get the dominant color palette for a image.</p>

<h3 id="end-point">End point</h3>

<p><code class="prettyprint">POST /v1/colors/image_color_palette</code></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>data</td>
<td>image/jpeg</td>
<td>(<strong>Required</strong>) The image. The image can be in PNG, JPEG, BMP, or GIF.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time_ms</td>
<td>The time taken in milliseconds.</td>
</tr>
<tr>
<td>color_palette</td>
<td>The top 5 dominant colors in the image.</td>
</tr>
</tbody></table>

<h1 id="cognitive-stylist">Cognitive Stylist</h1>

<p>Coming soon&hellip;</p>

<h2 id="what-goes-well-with-this">What goes well with this</h2>

<p>Given an fashion apparel suggest another apparel/accessory that goes well with it.</p>

<h1 id="zietgiest">Zietgiest</h1>

<p>Coming soon..</p>

<h2 id="color-trends">Color trends</h2>

<p>Analyze dominant color palette for a given instagram hashtag/user account.</p>

          <h1 id="errors">Errors</h1>

<p>The Cogntive Fashion API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The product is not in the catalog.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t json</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="python">python</a>
          </div>
      </div>
    </div>
  </body>
</html>
